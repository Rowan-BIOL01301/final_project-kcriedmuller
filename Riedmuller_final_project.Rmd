---
title: "Final Project"
subtitle: "Data Science for Biologists, Spring 2021"
author: "Kevin C. Riedmuller"
output:
 html_document:
   theme: cerulean
   highlight: tango
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
# DON'T CHANGE THE NEXT LINE, except to add NEW options if you have any.
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = TRUE, include = TRUE)

# Load all libraries you use HERE:
library(tidyverse)
```

<br><br>

## Introduction
I have become more interested in government and politics recently and I think this will be a good opportunity to learn more about some government programs. The [US Kids Spending](https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-09-15/readme.md) data set includes spending data on children, by state, from the year 1997 to 2016. I chose this data because I think it will be really interesting to see how spending trends change over time and how spending on kids compares across different states. This data also includes what government programs the money is coming from such as SNAP or unemployment benefits. I am curious to see how much these government programs are providing relative to one another and how their contributions have also changed over time. 

```{r read-examine-data}
kids <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-15/kids.csv')

glimpse(kids)
```

<br><br>

## Question 1

#### How does SNAP benefit spending per child in New Jersey compare, over time, to other states in the Northeast after adjusting for inflation?

### Methods
```{r question1_methods, fig.height = 5, fig.width = 7}
kids %>% # pipe in dataset
  drop_na() -> kids_nona # remove rows containing na and define variable

# define variable containing all Northeast states
northeast_region <- c("New Jersey", "Delaware", "Pennsylvania",
                      "Maine", "New Hampshire", "Vermont", "Massachusetts",
                      "Rhode Island", "Connecticut") 

kids_nona %>% # pipe in dataset
  select(- raw, -inf_adj) %>% # remove unnecessary columns
  filter(variable == "SNAP", # filter for rows containing SNAP information
         state %in% northeast_region) %>% # filter for rows containing Northeast states 
  mutate(perchild_dollars = inf_adj_perchild * 1000) %>% # make a column to transform per $1000 values to dollar values
  ggplot() + # add ggplot
  aes(x = year, # add year to x-axis
      y = perchild_dollars, # add inflation adjusted amount per child to y-axis
      color = state) + # map color to state
  geom_line() + # add lines
  scale_color_brewer(palette = "Paired") + # change color palette
  theme_dark() + # add dark theme
  theme(legend.position = "top") + # move legend to the top
  scale_x_continuous(n.breaks = 19, # specify x-axis breaks
                     guide = guide_axis(n.dodge = 2)) + # specify x-axis label locations
  scale_y_continuous(labels = scales::dollar) + # change y-axis labels to dollar amounts
  labs(y = "inflation adjusted SNAP spending per child", # change y-axis title
       x = "year") # change x-axis title
```

### Answer

From 1997 to about 2002, New Jersey only spent more per child in SNAP benefits than Massachusetts and New Hampshire, and about the same as Connecticut. From about 2003 to 2016, New Jersey spent more in SNAP benefits per child than New Hampshire.


<br><br>

## Question 2

#### On average, which Northeastern state spends the most money on parks and recreation services?

### Methods
```{r question2_methods, fig.height = 4, fig.width = 7}
kids_nona %>% # pipe in dataset
  select(state, variable, inf_adj) %>% # select columns of interest
  filter(variable == "parkrec", # filter rows for parks and recreation spending 
         state %in% northeast_region) %>% # filter rows for Northeastern states
  group_by(state) %>% # group by state
  summarize(mean_parkrec = mean(inf_adj)) %>% # create a column of average parks and rec spending by state
  ungroup() %>% # ungroup data
  ggplot() + # add ggplot
  aes(x = fct_reorder(state,mean_parkrec, .desc = TRUE), # add variable to x-axis and arrange in descending order of y-axis values
      y = mean_parkrec) + # add variable to y-axis
  geom_col(color = "black", # add bars and specify color 
             fill = "forestgreen") + # specify fill
  geom_text(aes(label = mean_parkrec), # display bar values
            vjust = -.5, # adjust bar label height
            size = 3, # adjust bar label size
            parse = TRUE) + # adjust bar label decimal points to fit label neatly within bar width
  scale_y_continuous(labels = scales::dollar) + # change y-axis labels to dollar amounts
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) + # stagger x-axis labels
  theme_linedraw() + # add linedraw theme
  labs(y = "average parks and recreation spending", # change y-axis label
       x = "state") # change x-axis label
```

### Answer

New Jersey spends the most money, on average, for parks and recreation services in the Northeast.

<br><br>

## Question 3

#### REPLACE TEXT WITH YOUR QUESTION. Your question should literally be a level-4 header.

### Methods

### Answer

Replace this text with your answer to your question.


<br><br>

## Question 4

#### REPLACE TEXT WITH YOUR QUESTION. Your question should literally be a level-4 header.

### Methods

### Answer

Replace this text with your answer to your question.
